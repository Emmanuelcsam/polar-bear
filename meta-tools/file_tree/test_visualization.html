<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Tree Visualizer</title>
    <style>
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #fff;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .stats {
            display: flex;
            gap: 30px;
            justify-content: center;
            font-size: 1.1em;
        }
        
        .stats span {
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }
        
        .view-tabs {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: rgba(255,255,255,0.1);
            color: #fff;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .tab-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .tab-btn.active {
            background: rgba(255,255,255,0.3);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .view-panel {
            display: none;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 30px;
            min-height: 600px;
            backdrop-filter: blur(10px);
        }
        
        .view-panel.active {
            display: block;
        }
        
        #tree-container {
            overflow: auto;
            max-height: 600px;
        }
        
        .tree-node {
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .tree-node:hover {
            transform: translateX(5px);
        }
        
        .tree-node.directory::before {
            content: "üìÅ ";
        }
        
        .tree-node.file::before {
            content: "üìÑ ";
        }
        
        .tree-children {
            margin-left: 25px;
            border-left: 2px solid rgba(255,255,255,0.2);
            padding-left: 10px;
        }
        
        #network-svg, #galaxy-container {
            width: 100%;
            height: 600px;
            border-radius: 10px;
            background: rgba(0,0,0,0.2);
        }
        
        .export-buttons {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }
        
        .export-buttons button {
            padding: 10px 20px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .export-buttons button:hover {
            background: rgba(255,255,255,0.3);
        }
        
        #export-content {
            width: 100%;
            height: 500px;
            background: rgba(0,0,0,0.3);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            resize: none;
        }
        
        .node {
            cursor: pointer;
        }
        
        .node circle {
            stroke: #fff;
            stroke-width: 2px;
        }
        
        .node text {
            font-size: 12px;
            fill: #fff;
        }
        
        .link {
            fill: none;
            stroke: rgba(255,255,255,0.3);
            stroke-width: 1px;
        }
        
    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üå≥ File Tree Visualizer</h1>
            <div class="stats">
                <span>üìÅ Directories: <strong id="dirCount">0</strong></span>
                <span>üìÑ Files: <strong id="fileCount">0</strong></span>
                <span>üíæ Total Size: <strong id="totalSize">0</strong></span>
            </div>
        </header>
        
        <nav class="view-tabs">
            <button class="tab-btn active" onclick="showView('tree', event)">üå≤ Tree View</button>
            <button class="tab-btn" onclick="showView('network', event)">üï∏Ô∏è Network View</button>
            <button class="tab-btn" onclick="showView('galaxy', event)">üåå Galaxy View</button>
            <button class="tab-btn" onclick="showView('export', event)">üì§ Export</button>
        </nav>
        
        <main>
            <div id="tree-view" class="view-panel active">
                <div id="tree-container"></div>
            </div>
            
            <div id="network-view" class="view-panel">
                <svg id="network-svg"></svg>
            </div>
            
            <div id="galaxy-view" class="view-panel">
                <div id="galaxy-container"></div>
            </div>
            
            <div id="export-view" class="view-panel">
                <h2>Export Options</h2>
                <div class="export-buttons">
                    <button onclick="exportAsText()">üìÑ Export as Text</button>
                    <button onclick="exportAsMarkdown()">üìù Export as Markdown</button>
                    <button onclick="copyToClipboard()">üìã Copy to Clipboard</button>
                </div>
                <textarea id="export-content" readonly></textarea>
            </div>
        </main>
    </div>
    
    <script>
        const treeData = {"name": "test_tree", "path": "/home/jarvis/Documents/GitHub/polar-bear/test_tree", "is_dir": true, "size": 38, "modified_time": "2025-07-07T18:54:43.126139", "file_type": null, "depth": 0, "children": [{"name": "file1.txt", "path": "/home/jarvis/Documents/GitHub/polar-bear/test_tree/file1.txt", "is_dir": false, "size": 13, "modified_time": "2025-07-07T18:54:43.126139", "file_type": "text", "depth": 1, "children": []}, {"name": "subfolder1", "path": "/home/jarvis/Documents/GitHub/polar-bear/test_tree/subfolder1", "is_dir": true, "size": 25, "modified_time": "2025-07-07T18:54:43.126139", "file_type": null, "depth": 1, "children": [{"name": "file2.py", "path": "/home/jarvis/Documents/GitHub/polar-bear/test_tree/subfolder1/file2.py", "is_dir": false, "size": 13, "modified_time": "2025-07-07T18:54:43.126139", "file_type": "code", "depth": 2, "children": []}, {"name": "nested", "path": "/home/jarvis/Documents/GitHub/polar-bear/test_tree/subfolder1/nested", "is_dir": true, "size": 12, "modified_time": "2025-07-07T18:54:43.126139", "file_type": null, "depth": 2, "children": [{"name": "file3.js", "path": "/home/jarvis/Documents/GitHub/polar-bear/test_tree/subfolder1/nested/file3.js", "is_dir": false, "size": 12, "modified_time": "2025-07-07T18:54:43.126139", "file_type": "code", "depth": 3, "children": []}]}]}, {"name": "subfolder2", "path": "/home/jarvis/Documents/GitHub/polar-bear/test_tree/subfolder2", "is_dir": true, "size": 0, "modified_time": "2025-07-07T18:54:43.125139", "file_type": null, "depth": 1, "children": []}]};
        const stats = {"total_files": 3, "total_dirs": 4, "total_size": 38, "root_path": "/home/jarvis/Documents/GitHub/polar-bear/test_tree"};
        
        // Update stats
        document.getElementById('dirCount').textContent = stats.total_dirs;
        document.getElementById('fileCount').textContent = stats.total_files;
        document.getElementById('totalSize').textContent = formatSize(stats.total_size);
        
        // View switching
        function showView(viewName, event) {
            document.querySelectorAll('.view-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(viewName + '-view').classList.add('active');
            event.target.classList.add('active');
            
            if (viewName === 'tree' && !document.getElementById('tree-container').innerHTML) {
                renderTreeView();
            } else if (viewName === 'network' && !document.getElementById('network-svg').innerHTML) {
                renderNetworkView();
            } else if (viewName === 'galaxy' && !window.galaxyScene) {
                renderGalaxyView();
            }
        }
        
        // Tree View
        function renderTreeView() {
            const container = document.getElementById('tree-container');
            container.innerHTML = '';
            renderTreeNode(treeData, container);
        }
        
        function renderTreeNode(node, parent) {
            const nodeDiv = document.createElement('div');
            nodeDiv.className = 'tree-node ' + (node.is_dir ? 'directory' : 'file');
            nodeDiv.textContent = node.name + (node.is_dir ? '/' : ' (' + formatSize(node.size) + ')');
            parent.appendChild(nodeDiv);
            
            if (node.children && node.children.length > 0) {
                const childrenDiv = document.createElement('div');
                childrenDiv.className = 'tree-children';
                parent.appendChild(childrenDiv);
                
                node.children.forEach(child => {
                    renderTreeNode(child, childrenDiv);
                });
                
                nodeDiv.onclick = () => {
                    childrenDiv.style.display = childrenDiv.style.display === 'none' ? 'block' : 'none';
                };
            }
        }
        
        // Network View
        function renderNetworkView() {
            const width = document.getElementById('network-svg').clientWidth;
            const height = 600;
            
            const svg = d3.select('#network-svg')
                .attr('width', width)
                .attr('height', height);
            
            const root = d3.hierarchy(treeData);
            const links = root.links();
            const nodes = root.descendants();
            
            const simulation = d3.forceSimulation(nodes)
                .force('link', d3.forceLink(links).id(d => d.id).distance(50))
                .force('charge', d3.forceManyBody().strength(-300))
                .force('center', d3.forceCenter(width / 2, height / 2));
            
            const link = svg.append('g')
                .selectAll('line')
                .data(links)
                .enter().append('line')
                .attr('class', 'link');
            
            const node = svg.append('g')
                .selectAll('g')
                .data(nodes)
                .enter().append('g')
                .attr('class', 'node')
                .call(d3.drag()
                    .on('start', dragstarted)
                    .on('drag', dragged)
                    .on('end', dragended));
            
            node.append('circle')
                .attr('r', d => d.data.is_dir ? 8 : 5)
                .attr('fill', d => d.data.is_dir ? '#4CAF50' : '#2196F3');
            
            node.append('text')
                .attr('dx', 12)
                .attr('dy', 4)
                .text(d => d.data.name);
            
            simulation.on('tick', () => {
                link
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);
                
                node.attr('transform', d => `translate(${d.x},${d.y})`);
            });
            
            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }
            
            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }
            
            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
        }
        
        // Galaxy View
        function renderGalaxyView() {
            const container = document.getElementById('galaxy-container');
            
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / 600, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            
            renderer.setSize(container.clientWidth, 600);
            container.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            const pointLight = new THREE.PointLight(0xffffff, 0.8);
            pointLight.position.set(50, 50, 50);
            scene.add(pointLight);
            
            // Create galaxy structure
            const group = new THREE.Group();
            
            function createNodeSphere(node, position, depth = 0) {
                const geometry = new THREE.SphereGeometry(node.is_dir ? 2 : 1, 32, 32);
                const material = new THREE.MeshPhongMaterial({
                    color: node.is_dir ? 0x4CAF50 : 0x2196F3,
                    emissive: node.is_dir ? 0x2E7D32 : 0x1565C0,
                    emissiveIntensity: 0.3
                });
                const sphere = new THREE.Mesh(geometry, material);
                sphere.position.copy(position);
                group.add(sphere);
                
                if (node.children) {
                    const angleStep = (Math.PI * 2) / node.children.length;
                    node.children.forEach((child, index) => {
                        const angle = angleStep * index;
                        const radius = 20 + depth * 10;
                        const childPos = new THREE.Vector3(
                            position.x + Math.cos(angle) * radius,
                            position.y + (Math.random() - 0.5) * 10,
                            position.z + Math.sin(angle) * radius
                        );
                        
                        // Create connection line
                        const points = [position, childPos];
                        const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                        const lineMaterial = new THREE.LineBasicMaterial({ 
                            color: 0xffffff, 
                            opacity: 0.3,
                            transparent: true 
                        });
                        const line = new THREE.Line(lineGeometry, lineMaterial);
                        group.add(line);
                        
                        createNodeSphere(child, childPos, depth + 1);
                    });
                }
            }
            
            createNodeSphere(treeData, new THREE.Vector3(0, 0, 0));
            scene.add(group);
            
            camera.position.z = 100;
            
            // Animation
            function animate() {
                requestAnimationFrame(animate);
                group.rotation.y += 0.002;
                renderer.render(scene, camera);
            }
            
            animate();
            window.galaxyScene = scene;
            
            // Mouse controls
            let mouseX = 0, mouseY = 0;
            container.addEventListener('mousemove', (event) => {
                const rect = container.getBoundingClientRect();
                mouseX = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                mouseY = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                camera.position.x = mouseX * 20;
                camera.position.y = mouseY * 20;
                camera.lookAt(scene.position);
            });
        }
        
        // Export functions
        function exportAsText() {
            const content = generateTextTree(treeData, '', true);
            document.getElementById('export-content').value = content;
        }
        
        function exportAsMarkdown() {
            let content = '# File Tree Structure\n\n';
            content += '**Root Path:** `' + stats.root_path + '`\n\n';
            content += '## Directory Structure\n\n';
            content += '```\n';
            content += generateTextTree(treeData, '', true);
            content += '\n```';
            document.getElementById('export-content').value = content;
        }
        
        function generateTextTree(node, prefix, isLast) {
            let result = '';
            const connector = isLast ? '‚îî‚îÄ‚îÄ ' : '‚îú‚îÄ‚îÄ ';
            const icon = node.is_dir ? 'üìÅ ' : 'üìÑ ';
            const sizeStr = !node.is_dir ? ' (' + formatSize(node.size) + ')' : '';
            
            if (node.depth === 0) {
                result += icon + node.name + '/\n';
            } else {
                result += prefix + connector + icon + node.name + (node.is_dir ? '/' : '') + sizeStr + '\n';
            }
            
            if (node.children) {
                const extension = isLast ? '    ' : '‚îÇ   ';
                node.children.forEach((child, index) => {
                    const isLastChild = index === node.children.length - 1;
                    const childPrefix = node.depth > 0 ? prefix + extension : '';
                    result += generateTextTree(child, childPrefix, isLastChild);
                });
            }
            
            return result;
        }
        
        // Utility functions
        function formatSize(bytes) {
            const units = ['B', 'KB', 'MB', 'GB', 'TB'];
            let size = bytes;
            let unitIndex = 0;
            
            while (size >= 1024 && unitIndex < units.length - 1) {
                size /= 1024;
                unitIndex++;
            }
            
            return size.toFixed(1) + units[unitIndex];
        }
        
        // Copy to clipboard function
        function copyToClipboard() {
            const content = document.getElementById('export-content').value;
            if (content) {
                navigator.clipboard.writeText(content).then(() => {
                    alert('Copied to clipboard!');
                }).catch(err => {
                    console.error('Failed to copy:', err);
                });
            } else {
                alert('Please generate an export first!');
            }
        }
        
        // Initialize tree view on load
        renderTreeView();
        
    </script>
</body>
</html>